# 要求
请按要求开发一个简易学生成绩管理系统，实现基础的成绩录入，查询和修改功能。同时以插件的形式扩展系统功能

基础功能：
1. 录入成绩
录入新同学成绩，成绩可能来自于命令行输入的字符串或指定的成绩单文件

成绩单示例：
姓名 语文 数学 英语
张三 80 81 85
李四 55 100 82
王五 (缺省) 62 75

2. 查询成绩
a. 查询科目最高/最低分
b. 以各科成绩对同学姓名排序
c. 各科目平均分

3. 修改成绩

扩展功能：
- 查找分数缺省的数据
- 基于 C++标准库实现定时器，可定期执行指定的一项基础功能

实现要求：
1. 以 c++命令行工具形式实现
2. 只考虑 windows 平台，用 cmake 定制编译流程
3. 功能插件应当以动态链接库形式被加载/卸载
4. 对关键接口编写单元测试（任意测试框架）

考察要点：
1. 掌握基础的数据结构和算法
2. 熟悉继承封装，模块解耦合
3. 熟悉宏，模板与指针的使用


# 实现


常规:
ScoreSheet，成员为Student
1. 使用map来实现
排序不方便
2. 使用vector来实现
修改(查找)不方便

一个学生结构体，存所有成绩
每门成绩又单独用vector<pair>存储

Student
姓名
功能：
录入，查询，修改

通过标准输入或成绩单文件 确定具体科目

录入
1. 读入表格，csv,json,xml?
2. 命令行
输入学生名称，创建对象
输入科目和成绩
停止输入

查询
a. 查询最高分和最低分时可无需排序
b. sort
c. 储存sum

修改
遍历

法2:
Subject
可以对每门成绩储存
用vector
或用map储存，key为name，value为score(不够好，因为map对value排序不方便，需要新的空间)

无法同时保证对name查找和对score排序均高效

用map将科目映射到对象
最高分和最低分用一个变量存储即可
而平均分，实时存储则需要考虑变量精度
若存总分，则需要考虑数据溢出

需要表示 缺省值
简单方法，所有的缺省值都输入-1

输入的一个坑
cin输入错误后将不会再输入
需要用cin.clear()清除错误标志
用cin.ignore()清除缓冲区

用std::string 可避免错误 但对于数字 需用atoi进行转换

解耦合

设计模式
单例模式
接口

插件 函数
插件的加载和卸载

将学生成绩管理类分解为一个核心类和多个可插入功能模块。

定义一个接口类，所有功能模块都要实现此接口类。

在核心类中使用接口类的指针，以便在运行时加载和卸载功能模块。

编写每个功能模块的实现，确保它们符合接口规范，并且能够加载和卸载。

使用动态链接库（DLL）将功能模块打包为可加载的库。

在核心类中使用CMake或类似工具，在编译时将核心类与所有功能模块链接起来。

使用您的学生成绩管理系统时，动态地加载和卸载需要的功能模块。

为了能够查找分数缺省的数据，需要一个

基础功能: 

录入成绩

- [x] 命令行输入
- [x] 成绩单文件
- [x] 特殊处理 (缺省值, 重复输入)
- [x] 异常处理 流式输入错误

支持的成绩单格式如下(TXT文件)，缺省值可用 -1 表示
```txt
姓名 语文 数学 英语
张三 80 81 85
李四 55 100 82
王五 (缺省) 62 75
```
  
查询成绩:

- [x] 查询科目最高/最低分
- [x] 以各科成绩对同学姓名排序
- [x] 各科目平均分
- [x] 异常处理 (无数据, 无此科目, 缺省值)

修改成绩
- [x] 缺省值处理
- [x] 异常处理 (无此学生, 无此科目)

拓展功能:

- [x] 查找分数缺省的数据
- [x] 基于 C++标准库实现定时器，可定期执行指定的一项基础功能
在通过计时器定期执行的过程中，子进程将在后台运行，无法直接接受标准输入，因此只能定期执行查询相关功能

单元测试: 关键接口
使用doctest实现对关键接口的单元测试
- [x] Subject
- [x] ScoreSheet

- [x] Windows平台测试

主菜单: 

将输入与执行分离

好的方法
用链表实现插入，保证有序，跳表实现
用map实现查找，key是名字，value指向链表节点
可能需要学点redis
https://blog.csdn.net/qq_33333654/article/details/127212040


https://www.hahack.com/codes/cmake

https://www.zhihu.com/question/52538590
实际实现中，使用了抽象工厂+单例两个设计模式：软件框架统一提供一个插件工厂，用户通过约定的插件id（比如.COM的GUID，比如company.product.module.class这样的字符串标识）创建插件实例。插件工厂提供注册接口，插件加载进内存后将各类型的构造器和id注册进去。插件动态库制作一个static全局静态对象，构造函数里注册插件类，析构函数里取消注册，这样可以在动态库加载时自动注册，卸载时自动取消注册。整个插件库不需要导出任何接口，因为纯虚接口无需链接，对象则是统一从框架的插件工厂获取。


